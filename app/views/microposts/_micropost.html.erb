<li id="micropost-<%= micropost.id %>">
  <%= link_to gravatar_for(micropost.user, size: 50), micropost.user %>
  <span class="user"><%= link_to micropost.user.name, micropost.user %></span>
  </br>
  <span class="title"><%= micropost.title %></span> <!-- Append link here -->
  <span class="content">
    <span class="glyphicon glyphicon-comment" aria-hidden="true"></span>
    <%= micropost.content %>
    </br>

    <span class="glyphicon glyphicon-time" aria-hidden="true"></span>
    <% if micropost.active == false %>
      <% day = micropost.current_day %>
      <% real_day = day - 1 %>
    <% end %>
    You are on day <%= real_day %> of <%= micropost.days_to_complete %>.

    <%= image_tag micropost.picture.url if micropost.picture? %>
    </br>

    <!-- Deadline Backend Logic -->
      <!-- Vars -->

    Deadline: 
    <% if micropost.active == false %>
      Completed
    <% else %> 
      <!-- Ruby Vars -->
      <% due_time = Delayed::Job.where(:user_id => current_user.id, :owner_type => "Micropost", :owner_id => micropost.id).order("created_at DESC").first.run_at %>
      <% seconds_remaining = due_time - Time.now %>
      <% next_due_date = seconds_remaining + 24.hours %>
      <% user = micropost.user %>

      <% if micropost.check_in_current == true %>
        <%= distance_of_time(next_due_date, :except => :seconds) %>
      <% elsif micropost.check_in_current == false && user.stage_or_queue_occupied_by(micropost.id) %>
        PAST DUE
      <% else %>
        <%= distance_of_time(seconds_remaining, :except => :seconds) %>
      <% end %> 
    <% end %>

  </span>
  <span class="timestamp">
    Posted <%= time_ago_in_words(micropost.created_at) %> ago.
    <% if current_user?(micropost.user) %>
      <%= link_to "delete", micropost, method: :delete,
                                       data: { confirm: "You sure?" } %>
    <% end %>
  </span>
</li>